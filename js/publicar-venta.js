const PLAN_DIAS_VENTA=30;document.getElementById('form-venta')?.addEventListener('submit',async function(e){e.preventDefault();const form=e.target;const files=document.getElementById('venta-fotos')?.files||[];const imagenes=await uploadMultipleFiles(files);const data=Object.fromEntries(new FormData(form).entries());const expireDate=new Date(Date.now()+PLAN_DIAS_VENTA*24*60*60*1000);const doc={...data,imagenes,createdAt:firebase.firestore.FieldValue.serverTimestamp(),expireAt:firebase.firestore.Timestamp.fromDate(expireDate),estado:'pendiente',activo:true,uid:(auth.currentUser&&auth.currentUser.uid)||null}; if(window.db) await db.collection('ventas').add(doc);const fd=new FormData(form);fd.append('images',JSON.stringify(imagenes));await sendToWeb3Forms(fd);showMsg(document.getElementById('msgv'),'Enviado. Pendiente de aprobaci√≥n.');form.reset();});