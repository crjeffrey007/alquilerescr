// js/listHandler.js - carga publicaciones filtradas por tipo
import { db } from './firebase.js';
import { collection, query, where, getDocs, orderBy } from 'https://www.gstatic.com/firebasejs/10.14.0/firebase-firestore.js';
async function cargar(tipo, contId){ const cont = document.getElementById(contId); if(!cont) return; cont.innerHTML = '<p>Cargando...</p>'; const q = query(collection(db,'publicaciones'), where('tipo','==', tipo), where('estado','==','aprobado'), orderBy('createdAt','desc')); const snap = await getDocs(q); cont.innerHTML=''; snap.forEach(s=>{ const d=s.data(); cont.innerHTML += `<div class="card"><img src="${d.imagenDestacada||'assets/hero/hero.jpg'}" style="height:140px;object-fit:cover"><h3>${d.titulo}</h3><p>${d.provincia||''} ${d.canton||''}</p><p>â‚¡${d.precio||''}</p><a href="https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(d.mapaUbicacion||'')}" target="_blank">Ver mapa</a></div>`; }); }
document.addEventListener('DOMContentLoaded', ()=>{ if(document.getElementById('listado')) cargar('alquiler','listado'); if(document.getElementById('listado-ventas')) cargar('venta','listado-ventas'); if(document.getElementById('listado-negocios')) cargar('negocio','listado-negocios'); });