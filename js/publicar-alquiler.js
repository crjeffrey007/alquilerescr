const PLAN_DIAS=30;document.getElementById('form-alquiler')?.addEventListener('submit',async function(e){e.preventDefault();const form=e.target;const files=document.getElementById('alquiler-fotos')?.files||[];const imagenes=await uploadMultipleFiles(files);const data=Object.fromEntries(new FormData(form).entries());const expireDate=new Date(Date.now()+PLAN_DIAS*24*60*60*1000);const doc={...data,imagenes,createdAt:firebase.firestore.FieldValue.serverTimestamp(),expireAt:firebase.firestore.Timestamp.fromDate(expireDate),estado:'pendiente',activo:true,uid:(auth.currentUser&&auth.currentUser.uid)||null,emailUsuario:(auth.currentUser&&auth.currentUser.email)||data.email||''}; if(window.db) await db.collection('alquileres').add(doc);const fd=new FormData(form);fd.append('images',JSON.stringify(imagenes));await sendToWeb3Forms(fd);showMsg(document.getElementById('msg'),'Enviado. Pendiente de aprobaci√≥n.');form.reset();});