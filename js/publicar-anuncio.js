const PLAN_DIAS_ANUNCIO=30;document.getElementById('form-anuncio')?.addEventListener('submit',async function(e){e.preventDefault();const form=e.target;const logo=document.getElementById('logo')?.files||[];const fotos=document.getElementById('imagenes')?.files||[];const urls=[]; if(logo.length) urls.push(...await uploadMultipleFiles(logo)); if(fotos.length) urls.push(...await uploadMultipleFiles(fotos));const data=Object.fromEntries(new FormData(form).entries());const expireDate=new Date(Date.now()+PLAN_DIAS_ANUNCIO*24*60*60*1000);const doc={...data,imagenes:urls,createdAt:firebase.firestore.FieldValue.serverTimestamp(),expireAt:firebase.firestore.Timestamp.fromDate(expireDate),estado:'pendiente',activo:true,uid:(auth.currentUser&&auth.currentUser.uid)||null}; if(window.db) await db.collection('anunciosComerciales').add(doc);const fd=new FormData(form);fd.append('images',JSON.stringify(urls));await sendToWeb3Forms(fd);showMsg(document.getElementById('msga'),'Enviado. Pendiente de aprobaci√≥n.');form.reset();});